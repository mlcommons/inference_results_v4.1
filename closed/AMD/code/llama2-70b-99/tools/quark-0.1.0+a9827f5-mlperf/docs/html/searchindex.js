Search.setIndex({"docnames": ["api_doc/apis", "api_doc/export", "api_doc/exporter_config", "api_doc/quantization", "api_doc/quantizer_config", "autoapi/quark/torch/export/api/index", "autoapi/quark/torch/export/config/config/index", "autoapi/quark/torch/quantization/api/index", "autoapi/quark/torch/quantization/config/config/index", "index", "md_sources/advanced_algorithm", "md_sources/calibration", "md_sources/example", "md_sources/example_gen", "md_sources/faq", "md_sources/faq_gen", "md_sources/install", "md_sources/model_export", "md_sources/quantization", "md_sources/quantization_scheme", "md_sources/quark_torch_llm_example_gen", "md_sources/quark_torch_main_gen", "md_sources/readme_for_tar", "md_sources/user_guide", "md_sources/user_guide_config_description", "md_sources/user_guide_config_description_gen", "md_sources/user_guide_dataloader", "md_sources/user_guide_dataloader_gen", "md_sources/user_guide_exporting", "md_sources/user_guide_exporting_gen", "md_sources/user_guide_feature_description", "md_sources/user_guide_feature_description_gen", "md_sources/user_guide_gen", "md_sources/user_guide_quick_start", "md_sources/user_guide_quick_start_gen"], "filenames": ["api_doc/apis.rst", "api_doc/export.rst", "api_doc/exporter_config.rst", "api_doc/quantization.rst", "api_doc/quantizer_config.rst", "autoapi/quark/torch/export/api/index.rst", "autoapi/quark/torch/export/config/config/index.rst", "autoapi/quark/torch/quantization/api/index.rst", "autoapi/quark/torch/quantization/config/config/index.rst", "index.rst", "md_sources/advanced_algorithm.md", "md_sources/calibration.md", "md_sources/example.md", "md_sources/example_gen.md", "md_sources/faq.md", "md_sources/faq_gen.md", "md_sources/install.md", "md_sources/model_export.md", "md_sources/quantization.md", "md_sources/quantization_scheme.md", "md_sources/quark_torch_llm_example_gen.md", "md_sources/quark_torch_main_gen.md", "md_sources/readme_for_tar.md", "md_sources/user_guide.md", "md_sources/user_guide_config_description.md", "md_sources/user_guide_config_description_gen.md", "md_sources/user_guide_dataloader.md", "md_sources/user_guide_dataloader_gen.md", "md_sources/user_guide_exporting.md", "md_sources/user_guide_exporting_gen.md", "md_sources/user_guide_feature_description.md", "md_sources/user_guide_feature_description_gen.md", "md_sources/user_guide_gen.md", "md_sources/user_guide_quick_start.md", "md_sources/user_guide_quick_start_gen.md"], "titles": ["APIs", "Exporting", "Exporter Configuration", "Quantization", "Quantizer Configuration", "quark.torch.export.api", "quark.torch.export.config.config", "quark.torch.quantization.api", "quark.torch.quantization.config.config", "Welcome to Quark\u2019s documentation!", "Advanced Algorithms", "Calibration Method", "Examples", "Examples", "Frequently Asked Questions (FAQ)", "Frequently Asked Questions (FAQ)", "Installation Guide", "Model Export", "Quantization", "Quantization Scheme", "Language Model Quantization using Quark", "Quark", "Quark", "User Guide", "Configuration Description", "Configuration Description", "Adding Calibration Datasets", "Adding Calibration Datasets", "Exporting", "Exporting", "Feature Description", "Feature Description", "User Guide", "Quick Start", "Quick Start"], "terms": {"user": [0, 7, 9, 20, 21, 24, 25, 26, 27, 30, 31, 33, 34], "face": [0, 26, 27], "quantiz": [0, 5, 9, 12, 13, 16, 21, 22, 23, 26, 27, 28, 29, 32, 33, 34], "export": [0, 7, 12, 13, 21, 23, 30, 31, 32, 33, 34], "configur": [0, 5, 6, 7, 8, 14, 15, 21, 23, 30, 31, 32, 33, 34], "pytorch": [5, 6, 7, 8, 9, 12, 13, 16, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32], "modelexport": [5, 28, 29, 33, 34], "config": [5, 7, 20, 21, 24, 25, 28, 29, 30, 31, 33, 34], "exporterconfig": [5, 6], "export_dir": [5, 28, 29], "pathlib": 5, "path": [5, 14, 15, 20, 22, 26, 27], "str": [5, 6, 7, 8], "tempfil": 5, "gettempdir": 5, "provid": [5, 7, 9, 20, 21, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34], "an": [5, 7, 8, 20, 24, 25, 26, 27], "deep": [5, 7, 9, 21], "learn": [5, 6, 7, 8, 9, 21], "model": [5, 6, 7, 8, 9, 12, 13, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34], "thi": [5, 7, 8, 16, 20, 22, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34], "convert": [5, 26, 27], "json": [5, 6, 20, 21, 23, 30, 31, 32], "safetensor": [5, 6, 20, 21, 23, 30, 31, 32], "file": [5, 16, 20], "onnx": [5, 6, 9, 20, 21, 23, 30, 31, 32, 33, 34], "graph": [5, 28, 29], "save": 5, "paramet": [5, 6, 7, 8, 24, 25, 30, 31], "object": [5, 7], "contain": [5, 7, 21, 28, 29], "set": [5, 7, 8, 20, 21, 23, 26, 27, 30, 31, 32, 33, 34], "union": [5, 7, 8], "The": [5, 7, 8, 20, 21, 24, 25, 26, 27, 28, 29], "target": [5, 7, 8, 24, 25], "diretori": 5, "could": 5, "string": 5, "export_model_info": [5, 28, 29], "nn": [5, 7, 24, 25, 30, 31], "model_typ": [5, 28, 29], "model_dtyp": [5, 28, 29], "dtype": [5, 8, 24, 25, 33, 34], "float16": [5, 20, 21, 28, 29, 30, 31], "export_typ": [5, 28, 29], "vllm": [5, 20, 21, 23, 30, 31, 32], "adopt": [5, 20, 21, 23, 30, 31, 32], "none": [5, 6, 8, 24, 25, 26, 27], "function": [5, 7, 26, 27, 28, 29], "aim": [5, 7, 21, 24, 25], "": [5, 7, 16, 22, 23, 32], "network": [5, 7], "architectur": 5, "i": [5, 6, 7, 8, 9, 16, 20, 21, 22, 24, 25, 26, 27, 28, 29, 30, 31], "store": 5, "includ": [5, 21, 24, 25, 28, 29], "weight": [5, 6, 8, 20, 21, 24, 25, 28, 29, 30, 31, 33, 34], "bia": [5, 8, 24, 25], "scale": [5, 6, 8, 20, 24, 25, 30, 31], "zero_point": 5, "ar": [5, 7, 8, 20, 21, 23, 24, 25, 28, 29, 30, 31, 32, 33, 34], "type": [5, 7, 8, 21, 24, 25, 26, 27, 30, 31, 33, 34], "e": [5, 8, 16, 24, 25], "g": [5, 8, 24, 25], "gpt2": 5, "gptj": 5, "llama": [5, 20, 21], "gptnext": 5, "data": [5, 6, 7, 8, 21, 24, 25, 26, 27, 30, 31, 33, 34], "default": [5, 6, 8, 24, 25], "specif": [5, 8, 24, 25, 26, 27, 28, 29], "format": [5, 6, 21, 23, 26, 27, 28, 29, 30, 31, 32], "which": [5, 8, 24, 25, 26, 27, 30, 31], "choic": 5, "nativ": [5, 9, 21], "If": [5, 7, 8, 16, 20, 21, 22, 24, 25, 26, 27, 33, 34], "custom": [5, 8, 20, 21, 24, 25], "compil": [5, 16, 20, 22, 28, 29], "current": [5, 21, 22, 28, 29], "intern": [5, 8], "test": 5, "us": [5, 6, 7, 8, 9, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32], "return": [5, 7, 26, 27], "exampl": [5, 7, 9, 20, 21, 23, 24, 25, 26, 27, 30, 31, 32], "export_path": [5, 28, 29, 33, 34], "output_dir": [5, 20, 28, 29], "from": [5, 6, 7, 8, 9, 21, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34], "import": [5, 7, 16, 21, 22, 24, 25, 28, 29, 30, 31, 33, 34], "custom_config": [5, 7, 21, 28, 29, 30, 31], "default_exporter_config": [5, 28, 29], "sinc": 5, "onli": [5, 20, 21, 28, 29, 30, 31, 33, 34], "requir": [5, 8, 16, 30, 31], "support": [5, 9, 14, 15, 21, 24, 25, 28, 29, 30, 31], "fp8": [5, 20, 21, 28, 29, 30, 31], "int4_per_group": 5, "w4a8_per_group": 5, "llama2": [5, 20, 28, 29], "7b": [5, 20, 28, 29], "13b": [5, 28, 29], "70b": [5, 28, 29], "llama3": [5, 28, 29], "8b": [5, 28, 29], "export_onnx_model": [5, 28, 29, 33, 34], "input_arg": [5, 28, 29, 33, 34], "tensor": [5, 7, 8, 20, 21, 24, 25, 28, 29, 30, 31, 33, 34], "tupl": 5, "float": [5, 8, 23, 24, 25, 30, 31, 32, 33, 34], "input_nam": 5, "list": [5, 6, 7, 8, 24, 25], "output_nam": 5, "verbos": 5, "bool": [5, 8], "fals": [5, 8, 24, 25, 26, 27, 28, 29, 33, 34], "opset_vers": 5, "do_constant_fold": 5, "true": [5, 8, 24, 25, 28, 29, 30, 31, 33, 34], "operator_export_typ": 5, "operatorexporttyp": 5, "uint4_int4_flag": [5, 28, 29], "input": [5, 7, 8, 24, 25, 26, 27, 30, 31, 33, 34], "name": [5, 6, 8, 20, 24, 25, 30, 31], "assign": 5, "node": [5, 28, 29], "order": 5, "empti": [5, 8, 24, 25], "output": [5, 8, 24, 25, 30, 31], "flag": 5, "control": [5, 6, 8], "show": [5, 14, 15], "log": 5, "option": [5, 6, 8, 16, 20, 22, 23, 24, 25, 32, 33, 34], "version": [5, 7, 16, 22], "ai": 5, "opset": 5, "valu": [5, 8, 24, 25, 30, 31], "latest": 5, "stabl": 5, "appli": [5, 8, 20, 24, 25], "constant": 5, "fold": 5, "optim": [5, 7, 8, 24, 25], "oper": [5, 6, 21, 28, 29, 30, 31], "onnx_fallthrough": 5, "onnx_aten": 5, "onnx_aten_fallback": 5, "indic": [5, 8, 24, 25], "uint4": [5, 20, 21, 28, 29, 30, 31], "int4": [5, 8, 20, 21, 24, 25, 28, 29, 30, 31], "mix": [5, 28, 29], "int8": [5, 8, 20, 21, 24, 25, 28, 29, 30, 31, 33, 34], "uint8": [5, 28, 29], "In": [5, 21, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34], "other": [5, 9, 16, 21, 23, 26, 27, 28, 29, 30, 31, 32, 33, 34], "word": [5, 28, 29], "both": [5, 28, 29, 30, 31], "cannot": [5, 14, 15, 28, 29], "api": [6, 8, 9, 16, 21, 22, 23, 30, 31, 32], "A": [6, 8, 20, 24, 25], "encapsul": [6, 8], "comprehens": [6, 8], "machin": [6, 8], "allow": [6, 8, 24, 25, 30, 31], "detail": [6, 8, 20, 21, 23, 26, 27, 30, 31, 32, 33, 34], "over": [6, 8, 14, 15], "across": [6, 8], "differ": [6, 8, 20, 30, 31], "json_export_config": 6, "jsonexporterconfig": 6, "global": [6, 8, 24, 25], "onnx_export_config": 6, "onnxexporterconfig": 6, "specifi": [6, 7, 8, 24, 25], "weight_merge_group": 6, "group": [6, 8, 20, 21, 24, 25, 28, 29, 30, 31], "share": [6, 30, 31], "same": [6, 8, 24, 25, 30, 31], "factor": [6, 8, 20, 30, 31], "These": 6, "should": [6, 7, 8, 24, 25, 26, 27], "correspond": 6, "origin": [6, 23, 30, 31, 32], "addition": 6, "wildcard": 6, "can": [6, 7, 8, 20, 21, 24, 25, 26, 27, 30, 31, 33, 34], "denot": 6, "rang": 6, "modelquant": [7, 21, 30, 31, 33, 34], "handl": [7, 8, 30, 31], "process": [7, 8, 16, 22, 24, 25, 30, 31], "base": [7, 21, 30, 31], "defin": [7, 8, 23, 24, 25, 26, 27, 30, 31, 32, 33, 34], "It": [7, 9, 21], "essenti": 7, "ensur": 7, "ha": [7, 21, 30, 31], "all": [7, 21, 22, 24, 25], "necessari": [7, 21], "assum": 7, "compat": [7, 26, 27], "quantize_model": [7, 21, 30, 31, 33, 34], "dataload": [7, 21, 23, 30, 31, 32, 33, 34], "util": [7, 21, 26, 27, 30, 31, 33, 34], "dict": [7, 8], "given": 7, "its": 7, "perform": [7, 8, 23, 30, 31, 32], "reduc": [7, 30, 31], "size": [7, 8, 20, 24, 25], "accept": [7, 26, 27], "calibr": [7, 20, 21, 23, 32, 33, 34], "dure": [7, 8, 24, 25, 26, 27, 30, 31], "depend": [7, 16], "either": [7, 26, 27], "directli": 7, "structur": 7, "dictionari": [7, 8, 24, 25, 26, 27], "adapt": 7, "approach": 7, "accordingli": 7, "term": 7, "thei": [7, 20, 26, 27, 33, 34], "expect": 7, "produc": [7, 20], "misalign": 7, "between": [7, 30, 31], "lead": 7, "error": [7, 16, 22, 30, 31], "alreadi": 7, "train": [7, 8, 21, 30, 31], "readi": 7, "simpl": [7, 26, 27], "more": [7, 9, 21, 22, 23, 30, 31, 32], "complex": 7, "now": [7, 16, 21, 22, 30, 31], "infer": [7, 30, 31], "potenti": 7, "improv": 7, "devic": [7, 8, 20, 21, 22, 24, 25, 26, 27], "prepar": 7, "transform": [7, 8, 21, 30, 31, 33, 34], "automodelforcausallm": [7, 21, 30, 31, 33, 34], "autotoken": [7, 21, 30, 31, 33, 34], "from_pretrain": [7, 21, 30, 31, 33, 34], "facebook": [7, 20, 21, 30, 31, 33, 34], "opt": [7, 20, 21, 30, 31, 33, 34], "125m": [7, 21, 30, 31, 33, 34], "eval": [7, 21, 30, 31, 33, 34], "token": [7, 21, 30, 31, 33, 34], "default_w_uint4_per_group_config": [7, 21, 30, 31], "quant_config": [7, 21, 24, 25, 30, 31, 33, 34], "global_quant_config": [7, 8, 21, 24, 25, 30, 31, 33, 34], "text": [7, 21, 30, 31, 33, 34], "hello": [7, 21, 30, 31, 33, 34], "how": [7, 8, 21, 26, 27, 30, 31, 33, 34], "you": [7, 20, 21, 26, 27, 30, 31, 33, 34], "tokenized_output": [7, 21, 30, 31, 33, 34], "return_tensor": [7, 21, 30, 31, 33, 34], "pt": [7, 21, 30, 31, 33, 34], "calib_dataload": [7, 21, 26, 27, 28, 29, 30, 31, 33, 34], "input_id": [7, 21, 26, 27, 30, 31, 33, 34], "quant_model": [7, 21, 30, 31, 33, 34], "freez": [7, 33, 34], "replac": [7, 21, 23, 30, 31, 32, 33, 34], "fakequant": 7, "freezedfakequant": 7, "want": [7, 33, 34], "torch_compil": [7, 20], "pleas": [7, 22, 26, 27, 30, 31, 33, 34], "first": [7, 16, 21, 22, 33, 34], "neural": 7, "layer": [7, 8, 24, 25, 30, 31], "modifi": 7, "hierarch": [8, 24, 25], "compon": [8, 16], "quantizationconfig": [8, 33, 34], "entir": [8, 24, 25], "unless": [8, 24, 25], "overridden": [8, 24, 25], "level": [8, 21, 24, 25], "layer_type_quant_config": [8, 24, 25], "map": [8, 24, 25], "conv2d": [8, 24, 25], "dens": [8, 24, 25], "layer_quant_config": [8, 24, 25], "per": [8, 20, 21, 24, 25, 28, 29, 30, 31, 33, 34], "exclud": [8, 24, 25], "enabl": [8, 24, 25], "select": [8, 24, 25], "algo_config": [8, 24, 25], "algoconfig": [8, 24, 25], "algorithm": [8, 21, 24, 25], "gptq": [8, 20, 21, 24, 25, 30, 31], "awq": [8, 20, 21, 24, 25, 30, 31], "after": [8, 21, 24, 25], "datatyp": [8, 24, 25], "fake_datatyp": 8, "chang": [8, 24, 25], "pre_quant_opt_config": [8, 24, 25], "prequantoptconfig": 8, "pre": [8, 24, 25], "equal": [8, 24, 25], "smoothquant": [8, 20, 21, 24, 25, 30, 31], "fake_dtyp": 8, "each": [8, 24, 25, 30, 31, 33, 34], "input_tensor": [8, 24, 25, 26, 27], "quantizationspec": [8, 33, 34], "follow": [8, 16, 20, 22, 24, 25, 30, 31], "setup": [8, 24, 25], "instead": [8, 24, 25], "output_tensor": [8, 24, 25], "abov": [8, 24, 25, 30, 31], "target_devic": [8, 24, 25], "devicetyp": [8, 24, 25], "cpu": [8, 14, 15, 16, 20, 21, 22, 24, 25, 30, 31], "gpu": [8, 20, 21, 24, 25, 30, 31], "ipu": [8, 24, 25], "within": 8, "is_dynam": [8, 24, 25, 33, 34], "whether": [8, 24, 25], "dynam": [8, 21, 24, 25, 30, 31, 33, 34], "static": [8, 21, 24, 25, 30, 31], "observer_cl": [8, 24, 25, 33, 34], "observerbas": 8, "observ": [8, 24, 25, 33, 34], "determin": [8, 24, 25, 30, 31], "like": [8, 14, 15, 24, 25], "min": [8, 24, 25, 30, 31], "max": [8, 24, 25, 30, 31], "qscheme": [8, 24, 25, 33, 34], "qschemetyp": [8, 24, 25, 33, 34], "scheme": [8, 24, 25], "per_tensor": [8, 24, 25, 33, 34], "per_channel": [8, 24, 25], "per_group": [8, 24, 25], "ch_axi": [8, 24, 25, 30, 31], "int": 8, "channel": [8, 21, 24, 25, 30, 31], "axi": [8, 24, 25, 30, 31], "group_siz": [8, 24, 25, 30, 31], "symmetr": [8, 20, 21, 24, 25, 33, 34], "around": [8, 24, 25], "zero": [8, 24, 25, 30, 31], "defer": [8, 24, 25], "higher": [8, 24, 25], "round_method": [8, 24, 25, 33, 34], "roundtyp": [8, 24, 25, 33, 34], "round": [8, 24, 25], "method": [8, 20, 21, 26, 27], "half_even": [8, 24, 25, 33, 34], "scale_typ": [8, 24, 25, 33, 34], "scaletyp": [8, 24, 25, 33, 34], "power": [8, 24, 25], "two": [8, 24, 25], "smoothquantconfig": 8, "smooth": 8, "typic": [8, 21, 26, 27, 30, 31], "identifi": [8, 21, 22], "alpha": 8, "adjust": [8, 30, 31], "formula": 8, "influenc": 8, "aggress": 8, "1": [8, 20, 30, 31, 33, 34], "scale_clamp_min": 8, "minimum": [8, 30, 31], "prevent": 8, "becom": 8, "too": 8, "small": 8, "1e": 8, "3": [8, 16, 20, 21, 30, 31, 33, 34], "scaling_lay": 8, "embedding_lay": 8, "embed": 8, "special": 8, "maintain": 8, "accuraci": [8, 30, 31], "model_decoder_lay": 8, "ani": 8, "particular": [8, 21], "decod": 8, "might": 8, "have": 8, "uniqu": 8, "awqconfig": 8, "activ": [8, 16, 30, 31], "awar": 8, "bit": 8, "width": 8, "precis": [8, 30, 31], "4": [8, 20, 26, 27, 30, 31, 33, 34], "sym": [8, 20], "mani": 8, "togeth": 8, "point": [8, 23, 30, 31, 32], "128": [8, 20, 24, 25, 26, 27], "algo_processor": 8, "awqprocessor": 8, "processor": 8, "logic": 8, "involv": [8, 30, 31], "mai": [8, 16, 22], "need": [8, 30, 31, 33, 34], "separ": 8, "gptqconfig": 8, "accur": [8, 30, 31], "post": [8, 21, 30, 31], "gener": [8, 26, 27, 30, 31], "center": 8, "number": 8, "damp_perc": 8, "percentag": 8, "dampen": 8, "effect": 8, "aid": 8, "mainten": 8, "0": [8, 16, 22, 24, 25], "01": 8, "desc_act": 8, "descend": 8, "enhanc": 8, "static_group": 8, "fix": [8, 30, 31], "initi": 8, "true_sequenti": 8, "truli": 8, "sequenti": 8, "manner": 8, "inside_layer_modul": 8, "preserv": 8, "qualiti": 8, "toolkit": [9, 21], "framework": [9, 21], "easi": [9, 21], "advanc": [9, 21, 22], "featur": [9, 21, 23, 24, 25, 32], "than": [9, 21, 30, 31], "multipl": [9, 21], "hw": [9, 21, 30, 31], "backend": [9, 21, 30, 31], "instal": 9, "guid": [9, 20, 21, 26, 27, 33, 34], "faq": [9, 21], "quark": [12, 13, 14, 15, 16, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34], "languag": [12, 13, 21, 22, 26, 27], "window": [14, 15, 21, 30, 31], "mode": [14, 15, 21, 30, 31], "doe": [14, 15, 16, 22], "fp16": [14, 15, 20], "solut": [14, 15], "becaus": [14, 15, 24, 25], "torch": [14, 15, 16, 20, 21, 22, 24, 25, 28, 29, 30, 31, 33, 34], "perfectli": [14, 15], "stuck": [14, 15], "phase": [14, 15], "long": [14, 15], "time": [14, 15, 16, 20, 22, 30, 31], "ten": [14, 15], "minut": [14, 15, 16, 22], "termin": [14, 15, 20, 21], "info": [14, 15, 21], "check": [14, 15, 16, 20, 21, 22], "start": [14, 15, 23, 32], "kernel": [14, 15, 16, 22], "build": [14, 15], "directori": [14, 15], "cach": [14, 15, 20, 21], "folder": [14, 15, 20], "torch_extens": [14, 15], "py39": [14, 15], "delet": [14, 15], "run": [14, 15, 16, 20, 21, 22, 30, 31], "again": [14, 15], "comput": [16, 22, 30, 31], "platform": [16, 22], "cuda": [16, 22, 30, 31, 33, 34], "rocm": [16, 22, 30, 31], "2": [16, 20, 21, 22, 30, 31, 33, 34], "download": [16, 20], "extract": 16, "whl": [16, 22], "packag": [16, 21, 22], "pip": [16, 22], "verifi": [16, 21, 22], "python": [16, 20, 22, 24, 25, 33, 34], "c": [16, 21, 22], "report": [16, 22], "done": [16, 22], "fast": [16, 22], "when": [16, 22], "your": [16, 21, 22], "avail": [16, 22], "take": [16, 22], "few": [16, 22], "subsequ": [16, 22], "call": [16, 22], "much": [16, 22], "faster": [16, 22], "To": [16, 22, 30, 31], "invok": [16, 22], "success": [16, 22], "command": [16, 22], "anaconda": 16, "Then": 16, "creat": [16, 26, 27], "conda": 16, "environ": 16, "below": [16, 21, 30, 31, 33, 34], "n": 16, "9": 16, "open": 16, "repositori": 16, "git": 16, "clone": 16, "http": 16, "gitenterpris": 16, "xilinx": 16, "com": 16, "amdneuralopt": 16, "cd": 16, "r": 16, "txt": 16, "main": 16, "document": [20, 21], "we": [20, 24, 25, 26, 27, 30, 31], "offer": [20, 30, 31], "sever": [20, 23, 32], "variou": [20, 21, 30, 31], "strategi": [20, 21], "wish": 20, "own": [20, 21, 26, 27], "dataset": [20, 21, 23, 30, 31, 32], "quant": [20, 24, 25], "refer": [20, 22, 26, 27, 30, 31], "help": [20, 24, 25, 30, 31], "famili": 20, "bfp16": 20, "fp8_kv_cach": 20, "w_uin4": 20, "a_bf16": 20, "meta": 20, "hf": 20, "qwen": 20, "5": [20, 21, 33, 34], "qwen1": [20, 21], "note": [20, 21], "repres": [20, 26, 27, 30, 31], "For": [20, 22, 26, 27, 28, 29, 30, 31], "checkpoint": 20, "access": 20, "submit": 20, "permiss": 20, "request": 20, "addit": 20, "see": 20, "page": 20, "huggingfac": 20, "upon": 20, "obtain": 20, "llama2_checkpoint_fold": 20, "language_model": [20, 22], "here": [20, 26, 27, 30, 31], "recip": 20, "evalu": 20, "without": 20, "python3": 20, "quantize_quark": 20, "py": [20, 26, 27], "model_dir": 20, "skip_quant": 20, "perplex": 20, "wikitext": [20, 21, 26, 27], "a100": 20, "4720": 20, "w": 20, "_": [20, 24, 25, 26, 27, 28, 29], "asymmetr": [20, 21], "quant_schem": [20, 28, 29], "w_uint4_per_group_asym": [20, 28, 29], "num_calib_data": 20, "quant_algo": 20, "pileval_for_awq_benchmark": 20, "seq_len": 20, "512": 20, "6168": 20, "w_int4_per_group_sym": [20, 28, 29], "model_export": 20, "vllm_adopted_safetensor": 20, "code": [20, 21], "successfulli": [20, 21], "one": [20, 30, 31], "displai": [20, 21], "7912": 20, "kv": [20, 21], "w_fp8_a_fp8": 20, "kv_cache_dtyp": 20, "5133": 20, "5093": 20, "6": 20, "o": 20, "w_fp8_a_fp8_o_fp8": 20, "5487": 20, "7": 20, "gate": 20, "proj": 20, "up": [20, 21, 26, 27], "merg": 20, "And": 20, "matrix": 20, "no_weight_matrix_merg": 20, "8": 20, "w_int8_a_int8_per_tensor_sym": 20, "data_typ": 20, "bfloat16": [20, 21, 28, 29, 30, 31], "develop": 21, "flexibl": 21, "effici": 21, "place": [21, 23, 30, 31, 32, 33, 34], "tool": 21, "kei": [21, 30, 31], "ptq": 21, "e4m3fn": [21, 30, 31], "minmax": [21, 24, 25, 30, 31], "percentil": [21, 24, 25, 30, 31], "mse": [21, 24, 25, 30, 31], "larg": [21, 22, 26, 27], "linux": [21, 30, 31], "system": [21, 30, 31], "llm": 21, "pilev": [21, 26, 27], "add": 21, "found": 21, "out": 21, "our": 21, "inform": [21, 22, 24, 25, 30, 31], "proce": 21, "program": 21, "been": 21, "complet": 21, "copyright": [21, 22], "2023": [21, 22], "micro": [21, 22], "inc": [21, 22], "right": [21, 22], "reserv": [21, 22], "spdx": [21, 22], "mit": [21, 22], "torchvis": 22, "about": [22, 30, 31], "html": 22, "doc": 22, "index": 22, "readm": 22, "md": 22, "There": [23, 32], "step": [23, 30, 31, 32, 33, 34], "load": [23, 32], "modul": [23, 24, 25, 30, 31, 32, 33, 34], "quick": [23, 32], "ad": [23, 32], "descript": [23, 32], "dataclass": [24, 25], "rigor": [24, 25], "avoid": [24, 25], "typo": [24, 25], "class": [24, 25, 26, 27], "demonstr": [24, 25, 30, 31], "certain": [24, 25], "instanc": [24, 25, 26, 27], "except": [24, 25], "fake": [24, 25], "preprocessconfig": [24, 25], "describ": [24, 25, 30, 31], "wise": [24, 25], "linear": [24, 25, 30, 31], "half": [24, 25], "even": [24, 25], "pertensorminmaxobserv": [24, 25, 33, 34], "perchannelminmaxobserv": [24, 25], "choos": [24, 25], "pertensorpercentileobserv": [24, 25], "pertensormseobserv": [24, 25], "normal": [26, 27], "conform": [26, 27], "rule": [26, 27], "offici": [26, 27], "link": [26, 27, 28, 29], "find": [26, 27], "section": [26, 27], "titl": [26, 27], "search": [26, 27], "keyword": [26, 27], "hug": [26, 27], "often": [26, 27, 30, 31], "three": [26, 27, 30, 31], "must": [26, 27], "rand": [26, 27], "batch_siz": [26, 27], "shuffl": [26, 27], "input_list": [26, 27], "collat": [26, 27], "fn": [26, 27], "def": [26, 27], "my_collate_fn": [26, 27], "block": [26, 27, 30, 31], "data_batch": [26, 27], "input_dict": [26, 27], "collate_fn": [26, 27], "in8": [28, 29], "quantizerlinear": [28, 29], "dequantizerlinear": [28, 29], "pair": [28, 29], "cast": [28, 29], "m": [28, 29, 30, 31], "batch_it": [28, 29], "iter": [28, 29], "next": [28, 29], "arg": [28, 29], "w_int4_per_channel_sym": [28, 29], "w_uint4_a_bfloat16_per_group_asym": [28, 29], "els": [28, 29], "design": [28, 29], "w4a8": [28, 29], "maxmin": [30, 31], "float32": [30, 31], "op": [30, 31], "single_gpu": [30, 31], "present": [30, 31], "explan": [30, 31, 33, 34], "distinct": [30, 31], "tailor": [30, 31], "meet": [30, 31], "ahead": [30, 31], "achiev": [30, 31], "best": [30, 31], "result": [30, 31], "necessit": [30, 31], "actual": [30, 31], "sampl": [30, 31], "uncom": [30, 31], "line": [30, 31], "default_w_int8_a_int8_per_tensor_dynamic_config": [30, 31], "default_w_fp8_a_fp8_per_tensor_config": [30, 31], "still": [30, 31, 33, 34], "simpli": [30, 31], "through": [30, 31], "chapter": [30, 31, 33, 34], "capabl": [30, 31], "mean": [30, 31], "scalar": [30, 31], "dimens": [30, 31], "d": [30, 31], "length": [30, 31], "shape": [30, 31], "d0": [30, 31], "di": [30, 31], "dn": [30, 31], "divid": [30, 31], "smaller": [30, 31], "independ": [30, 31], "primarili": [30, 31], "integ": [30, 31], "shift": [30, 31], "statist": [30, 31], "record": [30, 31], "maximum": [30, 31], "incom": [30, 31], "robust": [30, 31], "histogram": [30, 31], "rather": [30, 31], "absolut": [30, 31], "particularli": [30, 31], "manag": [30, 31], "outlier": [30, 31], "squar": [30, 31], "where": [30, 31], "minim": [30, 31], "predict": [30, 31], "regress": [30, 31], "context": [30, 31], "goal": [30, 31], "averag": [30, 31], "estim": [30, 31], "refin": [30, 31], "fine": [30, 31], "tune": [30, 31], "close": [30, 31], "possibl": [30, 31], "real": [30, 31], "attent": [30, 31], "re": [30, 31], "implement": [30, 31], "write": [33, 34], "script": [33, 34], "shown": [33, 34], "default_int8_per_tensor_sym_spec": [33, 34], "default_w_int8_per_tensor_config": [33, 34], "freezed_quantized_model": [33, 34], "get": [33, 34], "dummi": [33, 34], "break": [33, 34]}, "objects": {"quark.torch.export": [[5, 0, 0, "-", "api"]], "quark.torch.export.api": [[5, 1, 1, "", "ModelExporter"]], "quark.torch.export.api.ModelExporter": [[5, 2, 1, "", "export_model_info"], [5, 2, 1, "", "export_onnx_model"]], "quark.torch.export.config": [[6, 0, 0, "-", "config"]], "quark.torch.export.config.config": [[6, 1, 1, "", "ExporterConfig"], [6, 1, 1, "", "JsonExporterConfig"], [6, 1, 1, "", "OnnxExporterConfig"]], "quark.torch.quantization": [[7, 0, 0, "-", "api"]], "quark.torch.quantization.api": [[7, 1, 1, "", "ModelQuantizer"]], "quark.torch.quantization.api.ModelQuantizer": [[7, 2, 1, "", "freeze"], [7, 2, 1, "", "quantize_model"]], "quark.torch.quantization.config": [[8, 0, 0, "-", "config"]], "quark.torch.quantization.config.config": [[8, 1, 1, "", "AWQConfig"], [8, 1, 1, "", "Config"], [8, 1, 1, "", "GPTQConfig"], [8, 1, 1, "", "QuantizationConfig"], [8, 1, 1, "", "QuantizationSpec"], [8, 1, 1, "", "SmoothQuantConfig"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"]}, "titleterms": {"api": [0, 5, 7], "export": [1, 2, 5, 6, 17, 20, 28, 29], "configur": [2, 4, 24, 25], "quantiz": [3, 4, 7, 8, 10, 18, 19, 20, 24, 25, 30, 31], "quark": [5, 6, 7, 8, 9, 20, 21, 22], "torch": [5, 6, 7, 8, 26, 27], "class": [5, 6, 7, 8], "modul": [5, 6, 7, 8], "content": [5, 6, 7, 8], "config": [6, 8], "welcom": 9, "": 9, "document": [9, 22], "advanc": [10, 30, 31], "algorithm": [10, 30, 31], "pre": [10, 30, 31], "quant": [10, 30, 31], "optim": [10, 30, 31], "smoothquant": 10, "introduct": 10, "exampl": [10, 12, 13, 22, 28, 29], "gptq": 10, "awq": 10, "calibr": [11, 24, 25, 26, 27, 30, 31], "method": [11, 24, 25, 30, 31], "frequent": [14, 15], "ask": [14, 15], "question": [14, 15], "faq": [14, 15], "environ": [14, 15], "issu": [14, 15], "1": [14, 15], "c": [14, 15], "compil": [14, 15], "instal": [16, 21, 22], "guid": [16, 23, 32], "from": 16, "zip": 16, "sourc": 16, "code": 16, "model": [17, 20], "scheme": [19, 30, 31], "languag": 20, "us": 20, "support": 20, "prepar": 20, "script": 20, "pytorch": 21, "resourc": 21, "get": 21, "start": [21, 33, 34], "licens": [21, 22], "user": [23, 32], "descript": [24, 25, 30, 31], "set": [24, 25], "quantizationconfig": [24, 25], "strategi": [24, 25, 30, 31], "quantizationspec": [24, 25], "ad": [26, 27], "dataset": [26, 27], "dataload": [26, 27], "tensor": [26, 27], "list": [26, 27], "dict": [26, 27], "str": [26, 27], "onnx": [28, 29], "json": [28, 29], "safetensor": [28, 29], "vllm": [28, 29], "adopt": [28, 29], "featur": [30, 31], "The": [30, 31], "symmetr": [30, 31], "asymmetr": [30, 31], "kv": [30, 31], "cach": [30, 31], "quick": [33, 34]}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"APIs": [[0, "apis"]], "Exporting": [[1, "exporting"], [28, "exporting"], [29, "exporting"]], "Exporter Configuration": [[2, "exporter-configuration"]], "Quantization": [[3, "quantization"], [18, "quantization"]], "Quantizer Configuration": [[4, "quantizer-configuration"]], "quark.torch.export.api": [[5, "module-quark.torch.export.api"]], "Classes": [[5, "classes"], [6, "classes"], [7, "classes"], [8, "classes"]], "Module Contents": [[5, "module-contents"], [6, "module-contents"], [7, "module-contents"], [8, "module-contents"]], "quark.torch.export.config.config": [[6, "module-quark.torch.export.config.config"]], "quark.torch.quantization.api": [[7, "module-quark.torch.quantization.api"]], "quark.torch.quantization.config.config": [[8, "module-quark.torch.quantization.config.config"]], "Welcome to Quark\u2019s documentation!": [[9, "welcome-to-quark-s-documentation"]], "Advanced Algorithms": [[10, "advanced-algorithms"]], "Pre-Quant Optimization": [[10, "pre-quant-optimization"], [30, "pre-quant-optimization"], [31, "pre-quant-optimization"]], "SmoothQuant": [[10, "smoothquant"]], "Introduction": [[10, "introduction"], [10, "id1"], [10, "id3"]], "Example": [[10, "example"], [10, "id2"], [10, "id4"]], "Quantization Algorithm": [[10, "quantization-algorithm"]], "GPTQ": [[10, "gptq"]], "AWQ": [[10, "awq"]], "Calibration Method": [[11, "calibration-method"]], "Examples": [[12, "examples"], [13, "examples"], [22, "examples"]], "Frequently Asked Questions (FAQ)": [[14, "frequently-asked-questions-faq"], [15, "frequently-asked-questions-faq"]], "Environment Issues": [[14, "environment-issues"], [15, "environment-issues"]], "Issue 1": [[14, "issue-1"], [14, "id1"], [15, "issue-1"], [15, "id1"]], "C++ Compilation Issues": [[14, "c-compilation-issues"], [15, "c-compilation-issues"]], "Installation Guide": [[16, "installation-guide"]], "Install from ZIP": [[16, "install-from-zip"]], "Install from source code": [[16, "install-from-source-code"]], "Model Export": [[17, "model-export"]], "Quantization Scheme": [[19, "quantization-scheme"]], "Language Model Quantization using Quark": [[20, "language-model-quantization-using-quark"]], "Models supported": [[20, "models-supported"]], "Preparation": [[20, "preparation"]], "Quantization & Export Scripts": [[20, "quantization-export-scripts"]], "Quark": [[21, "quark"], [22, "quark"]], "Quark for Pytorch": [[21, "quark-for-pytorch"]], "Resources": [[21, "resources"]], "Installation": [[21, "installation"], [22, "installation"]], "Getting Started": [[21, "getting-started"]], "License": [[21, "license"], [22, "license"]], "Documentation": [[22, "documentation"]], "User Guide": [[23, "user-guide"], [32, "user-guide"]], "Configuration Description": [[24, "configuration-description"], [25, "configuration-description"]], "Setting QuantizationConfig": [[24, "setting-quantizationconfig"], [25, "setting-quantizationconfig"]], "Configuring Quantization Strategy (Setting QuantizationSpec)": [[24, "configuring-quantization-strategy-setting-quantizationspec"], [25, "configuring-quantization-strategy-setting-quantizationspec"]], "Configuring Calibration Method": [[24, "configuring-calibration-method"], [25, "configuring-calibration-method"]], "Adding Calibration Datasets": [[26, "adding-calibration-datasets"], [27, "adding-calibration-datasets"]], "Dataloader with Dataset as torch.Tensor": [[26, "dataloader-with-dataset-as-torch-tensor"], [27, "dataloader-with-dataset-as-torch-tensor"]], "Dataloader with List[Dict[str, torch.Tensor]] or List[torch.Tensor]": [[26, "dataloader-with-list-dict-str-torch-tensor-or-list-torch-tensor"], [27, "dataloader-with-list-dict-str-torch-tensor-or-list-torch-tensor"]], "Dataloader with Dict[str, torch.Tensor]": [[26, "dataloader-with-dict-str-torch-tensor"], [27, "dataloader-with-dict-str-torch-tensor"]], "Onnx Exporting": [[28, "onnx-exporting"], [29, "onnx-exporting"]], "Example of Onnx Exporting": [[28, "example-of-onnx-exporting"], [29, "example-of-onnx-exporting"]], "Json-Safetensors(vLLM Adopted) Exporting": [[28, "json-safetensors-vllm-adopted-exporting"], [29, "json-safetensors-vllm-adopted-exporting"]], "Example of Json-Safetensors(vLLM Adopted) Exporting": [[28, "example-of-json-safetensors-vllm-adopted-exporting"], [29, "example-of-json-safetensors-vllm-adopted-exporting"]], "Feature Description": [[30, "feature-description"], [31, "feature-description"]], "Quant Strategy": [[30, "quant-strategy"], [31, "quant-strategy"]], "The Quant Schemes": [[30, "the-quant-schemes"], [31, "the-quant-schemes"]], "The Symmetric/Asymmetric Quantization": [[30, "the-symmetric-asymmetric-quantization"], [31, "the-symmetric-asymmetric-quantization"]], "The Calibration Methods": [[30, "the-calibration-methods"], [31, "the-calibration-methods"]], "KV-Cache Quant": [[30, "kv-cache-quant"], [31, "kv-cache-quant"]], "Advanced Quant Algorithm": [[30, "advanced-quant-algorithm"], [31, "advanced-quant-algorithm"]], "Quick Start": [[33, "quick-start"], [34, "quick-start"]]}, "indexentries": {"modelexporter (class in quark.torch.export.api)": [[5, "quark.torch.export.api.ModelExporter"]], "export_model_info() (quark.torch.export.api.modelexporter method)": [[5, "quark.torch.export.api.ModelExporter.export_model_info"]], "export_onnx_model() (quark.torch.export.api.modelexporter method)": [[5, "quark.torch.export.api.ModelExporter.export_onnx_model"]], "module": [[5, "module-quark.torch.export.api"], [6, "module-quark.torch.export.config.config"], [7, "module-quark.torch.quantization.api"], [8, "module-quark.torch.quantization.config.config"]], "quark.torch.export.api": [[5, "module-quark.torch.export.api"]], "exporterconfig (class in quark.torch.export.config.config)": [[6, "quark.torch.export.config.config.ExporterConfig"]], "jsonexporterconfig (class in quark.torch.export.config.config)": [[6, "quark.torch.export.config.config.JsonExporterConfig"]], "onnxexporterconfig (class in quark.torch.export.config.config)": [[6, "quark.torch.export.config.config.OnnxExporterConfig"]], "quark.torch.export.config.config": [[6, "module-quark.torch.export.config.config"]], "modelquantizer (class in quark.torch.quantization.api)": [[7, "quark.torch.quantization.api.ModelQuantizer"]], "freeze() (quark.torch.quantization.api.modelquantizer method)": [[7, "quark.torch.quantization.api.ModelQuantizer.freeze"]], "quantize_model() (quark.torch.quantization.api.modelquantizer method)": [[7, "quark.torch.quantization.api.ModelQuantizer.quantize_model"]], "quark.torch.quantization.api": [[7, "module-quark.torch.quantization.api"]], "awqconfig (class in quark.torch.quantization.config.config)": [[8, "quark.torch.quantization.config.config.AWQConfig"]], "config (class in quark.torch.quantization.config.config)": [[8, "quark.torch.quantization.config.config.Config"]], "gptqconfig (class in quark.torch.quantization.config.config)": [[8, "quark.torch.quantization.config.config.GPTQConfig"]], "quantizationconfig (class in quark.torch.quantization.config.config)": [[8, "quark.torch.quantization.config.config.QuantizationConfig"]], "quantizationspec (class in quark.torch.quantization.config.config)": [[8, "quark.torch.quantization.config.config.QuantizationSpec"]], "smoothquantconfig (class in quark.torch.quantization.config.config)": [[8, "quark.torch.quantization.config.config.SmoothQuantConfig"]], "quark.torch.quantization.config.config": [[8, "module-quark.torch.quantization.config.config"]]}})